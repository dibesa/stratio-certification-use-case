{"id":"806ce427-5e93-4b9f-80e1-e37ae59e9f02","name":"final-use-case","description":"","settings":{"global":{"executionMode":"marathon","userPluginsJars":[],"preExecutionSqlSentences":[],"postExecutionSqlSentences":[],"addAllUploadedPlugins":true,"mesosConstraint":"","mesosConstraintOperator":"CLUSTER","parametersLists":["Environment"],"parametersUsed":["Global.DEFAULT_DELIMITER","Global.SPARK_CORES_MAX","Global.SPARK_DRIVER_CORES","Global.SPARK_DRIVER_JAVA_OPTIONS","Global.SPARK_DRIVER_MEMORY","Global.SPARK_EXECUTOR_CORES","Global.SPARK_EXECUTOR_EXTRA_JAVA_OPTIONS","Global.SPARK_EXECUTOR_MEMORY","Global.SPARK_LOCALITY_WAIT","Global.SPARK_LOCAL_PATH","Global.SPARK_MEMORY_FRACTION","Global.SPARK_TASK_MAX_FAILURES"],"udfsToRegister":[],"udafsToRegister":[],"mesosRole":"","marathonDeploymentSettings":{"gracePeriodSeconds":"","intervalSeconds":"","timeoutSeconds":"","maxConsecutiveFailures":"","forcePullImage":false,"privileged":false,"userEnvVariables":[],"userLabels":[],"logLevel":""}},"streamingSettings":{"window":"2s","blockInterval":"100ms","checkpointSettings":{"checkpointPath":"sparta/checkpoint","enableCheckpointing":true,"autoDeleteCheckpoint":true,"addTimeToCheckpointPath":false}},"sparkSettings":{"master":"mesos://zk://master.mesos:2181/mesos","sparkKerberos":true,"sparkDataStoreTls":true,"sparkMesosSecurity":true,"submitArguments":{"userArguments":[],"deployMode":"client","driverJavaOptions":"{{{Global.SPARK_DRIVER_JAVA_OPTIONS}}}"},"sparkConf":{"sparkResourcesConf":{"coresMax":"{{{Global.SPARK_CORES_MAX}}}","executorMemory":"{{{Global.SPARK_EXECUTOR_MEMORY}}}","executorCores":"{{{Global.SPARK_EXECUTOR_CORES}}}","driverCores":"{{{Global.SPARK_DRIVER_CORES}}}","driverMemory":"{{{Global.SPARK_DRIVER_MEMORY}}}","mesosExtraCores":"","localityWait":"{{{Global.SPARK_LOCALITY_WAIT}}}","taskMaxFailures":"{{{Global.SPARK_TASK_MAX_FAILURES}}}","sparkMemoryFraction":"{{{Global.SPARK_MEMORY_FRACTION}}}","sparkParallelism":""},"sparkHistoryServerConf":{"enableHistoryServerMonitoring":false,"sparkHistoryServerEventLogRotateEnable":false,"sparkHistoryServerEventLogRotateNum":"9","sparkHistoryServerEventLogRotateSize":"512"},"userSparkConf":[],"coarse":true,"sparkUser":"","sparkLocalDir":"{{{Global.SPARK_LOCAL_PATH}}}","sparkKryoSerialization":false,"sparkSqlCaseSensitive":true,"logStagesProgress":false,"hdfsTokenCache":true,"executorExtraJavaOptions":"{{{Global.SPARK_EXECUTOR_EXTRA_JAVA_OPTIONS}}}"}},"errorsManagement":{"genericErrorManagement":{"whenError":"Error"},"transformationStepsManagement":{"whenError":"Error","whenRowError":"RowError","whenFieldError":"FieldError"},"transactionsManagement":{"sendToOutputs":[],"sendStepData":false,"sendPredecessorsData":true,"sendInputData":true}}},"pipelineGraph":{"nodes":[{"name":"GermanData","stepType":"Input","className":"CsvInputStep","classPrettyName":"Csv","arity":["NullaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":140,"y":67}},"configuration":{"inputOptions":"[]","path":"/sparta/dibesa/german_credit_data.csv","debugOptions":"{\"path\":\"/sparta/dibesa/german_credit_data.csv\"}","header":true,"delimiter":"{{{Global.DEFAULT_DELIMITER}}}"},"supportedEngines":["Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData"],"lineageProperties":[]},{"name":"External_list","stepType":"Input","className":"CsvInputStep","classPrettyName":"Csv","arity":["NullaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":805.9458923339844,"y":384.50982666015625}},"configuration":{"inputOptions":"[]","path":"/sparta/dibesa/external_list.csv","debugOptions":"{\"path\":\"/sparta/dibesa/external_list.csv\"}","header":true,"delimiter":"{{{Global.DEFAULT_DELIMITER}}}"},"supportedEngines":["Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData"],"lineageProperties":[]},{"name":"IdMatch","stepType":"Transformation","className":"FilterTransformStep","classPrettyName":"Filter","arity":["UnaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":1029.9138488769531,"y":384.5098571777344}},"configuration":{"filterExp":"ID < 1000","inputSchemas":"[]"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData","DiscardedData"],"lineageProperties":[]},{"name":"Casting","stepType":"Transformation","className":"CastingTransformStep","classPrettyName":"Casting","arity":["UnaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":139.90963745117188,"y":233.84555053710938}},"configuration":{"outputFieldsFrom":"FIELDS","inputSchemas":"[]","fields":[{"name":"Age","type":"integer","nullable":true},{"name":"Credit amount","type":"float","nullable":true},{"name":"Duration","type":"integer","nullable":true},{"name":"Checking account","type":"string","nullable":true},{"name":"Housing","type":"string","nullable":true},{"name":"ID","type":"string","nullable":true},{"name":"Purpose","type":"string","nullable":true},{"name":"Saving accounts","type":"string","nullable":true}],"whenFieldError":"","whenRowError":""},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData","DiscardedData"],"lineageProperties":[]},{"name":"DataCleaned","stepType":"Transformation","className":"RenameColumnTransformStep","classPrettyName":"RenameColumns","arity":["UnaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":364.4608685844511,"y":60.58102765563035}},"configuration":{"columns":[{"name":"Checking account","alias":"Checking_account"},{"name":"Credit amount","alias":"Credit_amount"},{"name":"Saving accounts","alias":"Saving_account"}],"inputSchemas":"[]"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData"],"lineageProperties":[]},{"name":"NewFeatures","stepType":"Transformation","className":"TriggerTransformStep","classPrettyName":"Trigger","arity":["BinaryToNary","UnaryToNary","NaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":363.180882163673,"y":253.94478491180382}},"configuration":{"sql":"Select\n\tID,\n\tCASE WHEN Checking_account = 'little' THEN 1\n\t\tELSE 0 END AS Checking_little,\n\tCASE WHEN Checking_account = 'NA' THEN 1\n\t\tELSE 0 END AS Checking_null,\n\tCASE WHEN Checking_account = 'moderate' THEN 1\n\t\tELSE 0 END AS Checking_moderate,\n\tCASE WHEN Saving_account = 'little' THEN 1\n\t\tELSE 0 END AS Savings_little,\n\tCASE WHEN Saving_account = 'NA' THEN 1\n\t\tELSE 0 END AS Savings_null,\n\tCASE WHEN Purpose = 'radio/TV' THEN 1\n\t\tELSE 0 END AS Purpose_radioTV,\n\tCASE WHEN Housing = 'own' THEN 1\n\t\tELSE 0  END AS Housing_own,\n\tCASE WHEN Credit_amount > 10000 THEN 1\n\t\tELSE 0  END AS Credit_big,\n\tCASE WHEN Duration < 12 THEN 1\n\t\tELSE 0  END AS Duration_short,\n\tCASE WHEN Age < 27 THEN 1\n\t\tELSE 0  END AS Age_young\nfrom DataCleaned","discardConditions":"[]","inputSchemas":"[]","executeSqlWhenEmpty":true},"supportedEngines":["Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData","DiscardedData"],"lineageProperties":[]},{"name":"RenameColumns","stepType":"Transformation","className":"RenameColumnTransformStep","classPrettyName":"RenameColumns","arity":["UnaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":583.9823192013762,"y":60.34509047017852}},"configuration":{"columns":[{"name":"Purpose_radioTV","alias":"Purpose_radio/TV"}],"inputSchemas":"[]"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData"],"lineageProperties":[]},{"name":"Prediction","stepType":"Transformation","className":"MlModelTransformStep","classPrettyName":"MlModel","arity":["UnaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":582.7615639092338,"y":273.5321292751033}},"configuration":{"selectMlType":"ML_MODEL_URL","model":"dibesa-model","inputSchemas":"[]"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData"],"lineageProperties":[]},{"name":"ObtainProbability","stepType":"Transformation","className":"TriggerTransformStep","classPrettyName":"Trigger","arity":["BinaryToNary","UnaryToNary","NaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":932.5235392325211,"y":52.988347784742544}},"configuration":{"sql":"select ID, probability.values[1] as probability from Prediction","discardConditions":"[]","inputSchemas":"[]","executeSqlWhenEmpty":true},"supportedEngines":["Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData","DiscardedData"],"lineageProperties":[]},{"name":"Join","stepType":"Transformation","className":"JoinTransformStep","classPrettyName":"Join","arity":["BinaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":1285.7931230370702,"y":52.95365781727685}},"configuration":{"rightTable":"Casting2","leftTable":"ObtainProbability","inputSchemas":"[]","joinConditions":[{"leftField":"ID","rightField":"ID_external"}],"joinType":"INNER","joinReturn":"ALL"},"supportedEngines":["Batch","Streaming"],"executionEngine":"Batch","supportedDataRelations":["ValidData"],"lineageProperties":[]},{"name":"RenameID","stepType":"Transformation","className":"RenameColumnTransformStep","classPrettyName":"RenameColumns","arity":["UnaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":1286.3685361531416,"y":384.89774334461515}},"configuration":{"columns":[{"name":"ID","alias":"ID_external"}],"inputSchemas":"[]"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData"],"lineageProperties":[]},{"name":"Casting2","stepType":"Transformation","className":"CastingTransformStep","classPrettyName":"Casting","arity":["UnaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":1284.8266970312075,"y":217.43645068112096}},"configuration":{"outputFieldsFrom":"FIELDS","inputSchemas":"[]","fields":[{"name":"ID_external","type":"string","nullable":true},{"name":"AddressFraudCheck","type":"integer","nullable":true},{"name":"ContactAudit","type":"integer","nullable":true},{"name":"FraudSuspicion","type":"integer","nullable":true},{"name":"LegalCase","type":"integer","nullable":true},{"name":"PoliceReport","type":"integer","nullable":true},{"name":"UkvCheck","type":"integer","nullable":true}],"whenFieldError":"","whenRowError":""},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData","DiscardedData"],"lineageProperties":[]},{"name":"CheatsNumber","stepType":"Transformation","className":"TriggerTransformStep","classPrettyName":"Trigger","arity":["BinaryToNary","UnaryToNary","NaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":1572.300431587006,"y":53.373104777137854}},"configuration":{"sql":"select ID, probability, AddressFraudCheck, ContactAudit, FraudSuspicion, LegalCase, PoliceReport, \nUkvCheck, \nAddressFraudCheck + ContactAudit + FraudSuspicion + LegalCase + PoliceReport + UkvCheck as Number_of_cheats\nfrom Join\n","discardConditions":"[]","inputSchemas":"[]","executeSqlWhenEmpty":true},"supportedEngines":["Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData","DiscardedData"],"lineageProperties":[]},{"name":"RedFilter","stepType":"Transformation","className":"FilterTransformStep","classPrettyName":"Filter","arity":["UnaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":1866.0268936260356,"y":52.427689828343944}},"configuration":{"filterExp":"probability >= 0.6 or Number_of_cheats >= 2","inputSchemas":"[]"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData","DiscardedData"],"lineageProperties":[]},{"name":"GreenFilter","stepType":"Transformation","className":"FilterTransformStep","classPrettyName":"Filter","arity":["UnaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":2072.6224268076508,"y":273.93098021488447}},"configuration":{"filterExp":"probability <= 15 and Number_of_cheats = 0","inputSchemas":"[]"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData","DiscardedData"],"lineageProperties":[]},{"name":"AddRedClass","stepType":"Transformation","className":"AddColumnsTransformStep","classPrettyName":"AddColumns","arity":["UnaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":2189.704150671959,"y":53.26880999023024}},"configuration":{"columns":[{"field":"Class","query":"Red","type":"string"}],"inputSchemas":"[]"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData"],"lineageProperties":[]},{"name":"AddGreenClass","stepType":"Transformation","className":"AddColumnsTransformStep","classPrettyName":"AddColumns","arity":["UnaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":2363.6934320344913,"y":273.77003550082594}},"configuration":{"columns":[{"field":"Class","query":"Green","type":"string"}],"inputSchemas":"[]"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData"],"lineageProperties":[]},{"name":"AddYellowClass","stepType":"Transformation","className":"AddColumnsTransformStep","classPrettyName":"AddColumns","arity":["UnaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":2372.3066454360805,"y":508.052525884483}},"configuration":{"columns":[{"field":"Class","query":"Yellow","type":"string"}],"inputSchemas":"[]"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData"],"lineageProperties":[]},{"name":"output","stepType":"Transformation","className":"UnionTransformStep","classPrettyName":"Union","arity":["NaryToNary"],"writer":{"saveMode":"Append","tableName":"","partitionBy":"","errorTableName":"","discardTableName":""},"uiConfiguration":{"position":{"x":2672.0507809572514,"y":268.60196915629234}},"configuration":{"inputSchemas":"[]"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","supportedDataRelations":["ValidData"],"lineageProperties":[]},{"name":"Parquet","stepType":"Output","className":"ParquetOutputStep","classPrettyName":"Parquet","arity":["NullaryToNullary","NaryToNullary"],"writer":{"saveMode":"Append"},"uiConfiguration":{"position":{"x":2937.341098251097,"y":101.50343888786375}},"configuration":{"path":"/sparta/dibesa/","errorSink":false,"saveOptions":"[]"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","lineageProperties":[]},{"name":"Csv","stepType":"Output","className":"CsvOutputStep","classPrettyName":"Csv","arity":["NullaryToNullary","NaryToNullary"],"writer":{"saveMode":"Append"},"uiConfiguration":{"position":{"x":2952.845253912066,"y":437.42320245397985}},"configuration":{"path":"/sparta/dibesa","errorSink":false,"inferSchema":false,"header":false,"saveOptions":"[]","delimiter":"{{{Global.DEFAULT_DELIMITER}}}"},"supportedEngines":["Streaming","Batch"],"executionEngine":"Batch","lineageProperties":[]}],"edges":[{"origin":"External_list","destination":"IdMatch","dataType":"ValidData"},{"origin":"GermanData","destination":"Casting","dataType":"ValidData"},{"origin":"Casting","destination":"DataCleaned","dataType":"ValidData"},{"origin":"DataCleaned","destination":"NewFeatures","dataType":"ValidData"},{"origin":"NewFeatures","destination":"RenameColumns","dataType":"ValidData"},{"origin":"RenameColumns","destination":"Prediction","dataType":"ValidData"},{"origin":"Prediction","destination":"ObtainProbability","dataType":"ValidData"},{"origin":"ObtainProbability","destination":"Join","dataType":"ValidData"},{"origin":"IdMatch","destination":"RenameID","dataType":"ValidData"},{"origin":"RenameID","destination":"Casting2","dataType":"ValidData"},{"origin":"Casting2","destination":"Join","dataType":"ValidData"},{"origin":"Join","destination":"CheatsNumber","dataType":"ValidData"},{"origin":"CheatsNumber","destination":"RedFilter","dataType":"ValidData"},{"origin":"RedFilter","destination":"GreenFilter","dataType":"DiscardedData"},{"origin":"RedFilter","destination":"AddRedClass","dataType":"ValidData"},{"origin":"GreenFilter","destination":"AddGreenClass","dataType":"ValidData"},{"origin":"GreenFilter","destination":"AddYellowClass","dataType":"DiscardedData"},{"origin":"AddRedClass","destination":"output","dataType":"ValidData"},{"origin":"AddGreenClass","destination":"output","dataType":"ValidData"},{"origin":"AddYellowClass","destination":"output","dataType":"ValidData"},{"origin":"output","destination":"Parquet","dataType":"ValidData"},{"origin":"output","destination":"Csv","dataType":"ValidData"}]},"executionEngine":"Batch","uiSettings":{"position":{"x":-592.11413044441,"y":44.077676035987736,"k":0.5804957862944964}},"lastUpdateDate":"2019-11-05T15:50:12Z","version":0,"group":{"id":"0600e71b-fce8-4116-8dbb-c645f071f9fd","name":"/home/ey/dibesa/credit-scoring"},"debugMode":false,"versionSparta":"2.6.5-35bdbc7","groupId":"0600e71b-fce8-4116-8dbb-c645f071f9fd"}